# Clinical sentiment in MIMIC-III

Manuscript under review

## Setup

### Data

* `data-raw/` should contain:
   * `negative_keywords.csv`
   * `positive_keywords.csv`
   * `sentence-labels.csv`
   * `mimic` subdirectory with MIMIC-III files (copy or create a symlink)
   
The `data/`, `models/`, `tables/`, `visuals/` directories have no tracked files but are
created in order to contain the files generated by the analysis.

### Conda environment

Run `mamba env create --file environment.yml` to install the necessary python packages. Then activate the conda environment `conda activate clinical-sentiment`.

### R environment

Run `renv::restore()` to setup the R packages via `renv`. If any errors pop up, you may need to install a few packages manually.

## Execution

This project contains an unfortunately complex mixture of python and R analyses. 

### Initial python analysis

First, one should run the python notebooks loosely numbered 01-06.

Then, `deep-learning-model.ipynb` can be run to train the deberta-v3 model.

Then run `labels-benchmarks.ipynb` to run sentiment analysis with the python-based comparison sentiment packages (Stanza, Pattern).

### R secondary analysis

First run `clean-keywords.Rmd`, then `analyze-keywords.Rmd`.

Note: `data/` should contain `keyword_prevalence_per_patient_10.12.csv`, generated by `MIMIC_004_keyword_prevalence-per_patient.ipynb`
